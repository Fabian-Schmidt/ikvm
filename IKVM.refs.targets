<Project>

    <ItemGroup>
        <ProjectReference Include="$(MSBuildThisFileDirectory)src\IKVM.ByteCode\IKVM.ByteCode.csproj">
            <ReferenceOutputAssembly>true</ReferenceOutputAssembly>
            <PrivateAssets>all</PrivateAssets>
        </ProjectReference>
        <ProjectReference Include="$(MSBuildThisFileDirectory)src\IKVM.Java\IKVM.Java.msbuildproj">
            <ReferenceOutputAssembly>true</ReferenceOutputAssembly>
            <PrivateAssets>all</PrivateAssets>
        </ProjectReference>
        <ProjectReference Include="$(MSBuildThisFileDirectory)src\IKVM.Runtime\IKVM.Runtime.csproj">
            <ReferenceOutputAssembly>true</ReferenceOutputAssembly>
            <PrivateAssets>all</PrivateAssets>
        </ProjectReference>
    </ItemGroup>

    <ItemGroup>
        <__ClangProjects Include="$(MSBuildThisFileDirectory)src\libjvm\libjvm.clangproj " />
        <__ClangProjects Include="$(MSBuildThisFileDirectory)src\libfdlibm\libfdlibm.clangproj " />
        <__ClangProjects Include="$(MSBuildThisFileDirectory)src\libverify\libverify.clangproj" />
        <__ClangProjects Include="$(MSBuildThisFileDirectory)src\libjava\libjava.clangproj" />
        <__ClangProjects Include="$(MSBuildThisFileDirectory)src\libunpack\libunpack.clangproj" />
        <__ClangProjects Include="$(MSBuildThisFileDirectory)src\libsunec\libsunec.clangproj" />
        <__ClangProjects Include="$(MSBuildThisFileDirectory)src\libj2pkcs11\libj2pkcs11.clangproj" />
        <__ClangProjects Include="$(MSBuildThisFileDirectory)src\libsunmscapi\libsunmscapi.clangproj" SupportedRuntimes="win7-x64;win7-x86;win10-arm64" />
    </ItemGroup>

    <Target Name="GetClangProjectReferencesByRuntime" Inputs="@(__ClangProjects)" Outputs="%(__ClangProjects.Identity)\null" BeforeTargets="AssignClangProjectConfiguration">
        <PropertyGroup>
            <__SupportedRuntimes>%(__ClangProjects.SupportedRuntimes)</__SupportedRuntimes>
            <__SupportedRuntimes Condition=" '$(__SupportedRuntimes)' == '' ">$(SupportedRuntimes)</__SupportedRuntimes>
        </PropertyGroup>
        <ItemGroup>
            <__SupportedRuntimes Include="$(__SupportedRuntimes)" />
        </ItemGroup>
        <ItemGroup>
            <__ClangProjectReference Include="@(__ClangProjects)">
                <RuntimeIdentifier>%(__SupportedRuntimes.Identity)</RuntimeIdentifier>
            </__ClangProjectReference>
            <ClangProjectReference Include="@(__ClangProjectReference)" Condition="$(_EnabledRuntimes.Contains(';%(RuntimeIdentifier);'))">
                <RuntimeIdentifier>%(RuntimeIdentifier)</RuntimeIdentifier>
            </ClangProjectReference>
        </ItemGroup>
    </Target>

    <PropertyGroup>
        <GetClangProjectReferencesDependsOn>
            $(GetClangProjectReferencesDependsOn);
            GetClangProjectReferencesByRuntime;
        </GetClangProjectReferencesDependsOn>
    </PropertyGroup>

</Project>
