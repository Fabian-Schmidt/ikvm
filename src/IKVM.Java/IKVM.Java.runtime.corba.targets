<!--

    IKVM.Java.runtime.corba.targets
    
    Build targets for the OpenJDK corba distribution.

-->

<Project>
    <PropertyGroup>
        <MSBuildAllProjects>$(MSBuildAllProjects);$(MSBuildThisFileFullPath)</MSBuildAllProjects>
    </PropertyGroup>

    <PropertyGroup>
        <CorbaBuildToolsOutputPath>$(IntermediateOutputPath)corba_btclasses\</CorbaBuildToolsOutputPath>
        <CorbaBuildToolsResponseFile>$(IntermediateOutputPath)corba_btclasses.javac.rsp</CorbaBuildToolsResponseFile>
        <CorbaBuildToolsStampFile>$(CorbaBuildToolsOutputPath)stamp</CorbaBuildToolsStampFile>
    </PropertyGroup>

    <ItemGroup>
        <CorbaBuildToolsSource Include="$(OpenJdkDir)corba\make\tools\src\**\*.java" />
    </ItemGroup>

    <Target Name="CorbaBuildToolsResponseFile" Inputs="$(MSBuildThisFileFullPath);@(CorbaBuildToolsSource)" Outputs="$(CorbaBuildToolsResponseFile)">
        <ItemGroup>
            <_CorbaBuildToolsJavaCompilerArgs Include="-nowarn" />
            <_CorbaBuildToolsJavaCompilerArgs Include="-d" />
            <_CorbaBuildToolsJavaCompilerArgs Include="$(CorbaBuildToolsOutputPath)" />
            <_CorbaBuildToolsJavaCompilerArgs Include="@(CorbaBuildToolsSource->'%(FullPath)')" />
        </ItemGroup>
        <WriteLinesToFile File="$(CorbaBuildToolsResponseFile)" Lines="@(_CorbaBuildToolsJavaCompilerArgs)" Overwrite="true" WriteOnlyWhenDifferent="true" />

        <ItemGroup>
            <FileWrites Include="$(CorbaBuildToolsResponseFile)" />
        </ItemGroup>
    </Target>

    <Target Name="BuildCorbaBuildTools" DependsOnTargets="ResolveJavaCompiler;CorbaBuildToolsResponseFile" Inputs="$(MSBuildThisFileFullPath);@(CorbaBuildToolsSource);$(CorbaBuildToolsResponseFile)" Outputs="$(CorbaBuildToolsStampFile)">
        <Error Text="Could not locate javac executable." Condition=" '$(JavaCompilerPath)' == '' " />
        <Error Text="javac could not be located at '$(JavaCompilerPath)'." Condition="!Exists('$(JavaCompilerPath)')" />
        <Exec Command="chmod +x $(JavaCompilerPath) >/dev/null 2>&amp;1" IgnoreExitCode="true" IgnoreStandardErrorWarningFormat="true" StandardErrorImportance="low" ContinueOnError="true" Condition="$([MSBuild]::IsOSUnixLike())" />

        <Delete Files="$(CorbaBuildToolsStampFile)" />
        <RemoveDir Directories="$(CorbaBuildToolsOutputPath)" />
        <MakeDir Directories="$(CorbaBuildToolsOutputPath)" />
        <Message Text="$(JavaCompilerExec) @$(CorbaBuildToolsResponseFile)" />
        <Exec Command="$(JavaCompilerExec) @$(CorbaBuildToolsResponseFile)" />
        <Touch Files="$(CorbaBuildToolsStampFile)" AlwaysCreate="true" ForceTouch="true" />

        <ItemGroup>
            <FileWrites Include="$(CorbaBuildToolsStampFile)" />
            <FileWrites Include="$(CorbaBuildToolsOutputPath)**\*.class" />
            <CorbaBuildToolsClasses Include="$(CorbaBuildToolsOutputPath)**\*.class" />
        </ItemGroup>
    </Target>

    <PropertyGroup>
        <CoreCompileDependsOn>
            BuildCorbaBuildTools;
            $(CoreCompileDependsOn);
        </CoreCompileDependsOn>
    </PropertyGroup>

    <PropertyGroup>
        <CorbaIDLJOutputPath>$(IntermediateOutputPath)corba_idlj\</CorbaIDLJOutputPath>
        <CorbaIDLJResponseFile>$(IntermediateOutputPath)corba_idlj.javac.rsp</CorbaIDLJResponseFile>
        <CorbaIDLJStampFile>$(CorbaIDLJOutputPath)stamp</CorbaIDLJStampFile>
    </PropertyGroup>

    <ItemGroup>
        <CorbaIDLJSource Include="$(OpenJdkDir)corba\src\share\classes\com\sun\tools\corba\se\idl\**\*.java" />
    </ItemGroup>

    <Target Name="CorbaIDLJResponseFile" Inputs="$(MSBuildThisFileFullPath);@(CorbaIDLJSource)" Outputs="$(CorbaIDLJResponseFile)">
        <ItemGroup>
            <_CorbaIDLJJavaCompilerArgs Include="-nowarn" />
            <_CorbaIDLJJavaCompilerArgs Include="-d" />
            <_CorbaIDLJJavaCompilerArgs Include="$(CorbaIDLJOutputPath)" />
            <_CorbaIDLJJavaCompilerArgs Include="@(CorbaIDLJSource->'%(FullPath)')" />
        </ItemGroup>
        <WriteLinesToFile File="$(CorbaIDLJResponseFile)" Lines="@(_CorbaIDLJJavaCompilerArgs)" Overwrite="true" WriteOnlyWhenDifferent="true" />

        <ItemGroup>
            <FileWrites Include="$(CorbaIDLJResponseFile)" />
        </ItemGroup>
    </Target>

    <Target Name="BuildCorbaIDLJ" DependsOnTargets="ResolveJavaCompiler;CorbaIDLJResponseFile" Inputs="$(MSBuildThisFileFullPath);@(CorbaIDLJSource);$(CorbaIDLJResponseFile)" Outputs="$(CorbaIDLJStampFile)">
        <Error Text="Could not locate javac executable." Condition=" '$(JavaCompilerPath)' == '' " />
        <Error Text="javac could not be located at '$(JavaCompilerPath)'." Condition="!Exists('$(JavaCompilerPath)')" />
        <Exec Command="chmod +x $(JavaCompilerPath) >/dev/null 2>&amp;1" IgnoreExitCode="true" IgnoreStandardErrorWarningFormat="true" StandardErrorImportance="low" ContinueOnError="true" Condition="$([MSBuild]::IsOSUnixLike())" />

        <Delete Files="$(CorbaIDLJStampFile)" />
        <RemoveDir Directories="$(CorbaIDLJOutputPath)" />
        <MakeDir Directories="$(CorbaIDLJOutputPath)" />
        <Message Text="$(JavaCompilerExec) @$(CorbaIDLJResponseFile)" />
        <Exec Command="$(JavaCompilerExec) @$(CorbaIDLJResponseFile)" />
        <Touch Files="$(CorbaIDLJStampFile)" AlwaysCreate="true" ForceTouch="true" />

        <ItemGroup>
            <FileWrites Include="$(CorbaIDLJStampFile)" />
            <FileWrites Include="$(CorbaIDLJOutputPath)**\*.class" />
            <CorbaIDLJClasses Include="$(CorbaIDLJOutputPath)**\*.class" />
        </ItemGroup>
    </Target>

    <PropertyGroup>
        <CorbaLogUtilOutputPath>$(IntermediateOutputPath)corba_logutil\</CorbaLogUtilOutputPath>
        <CorbaLogUtilResponseFile>$(IntermediateOutputPath)corba_logutil.javac.rsp</CorbaLogUtilResponseFile>
        <CorbaLogUtilStampFile>$(CorbaLogUtilOutputPath)stamp</CorbaLogUtilStampFile>
    </PropertyGroup>

    <ItemGroup>
        <CorbaLogUtilSource Include="$(OpenJdkDir)corba\src\share\classes\com\sun\tools\corba\se\logutil\**\*.java" />
    </ItemGroup>

    <Target Name="CorbaLogUtilResponseFile" Inputs="$(MSBuildThisFileFullPath);@(CorbaLogUtilSource)" Outputs="$(CorbaLogUtilResponseFile)">
        <ItemGroup>
            <_CorbaIDLJJavaCompilerArgs Include="-nowarn" />
            <_CorbaIDLJJavaCompilerArgs Include="-d" />
            <_CorbaIDLJJavaCompilerArgs Include="$(CorbaLogUtilOutputPath)" />
            <_CorbaIDLJJavaCompilerArgs Include="@(CorbaLogUtilSource->'%(FullPath)')" />
        </ItemGroup>
        <WriteLinesToFile File="$(CorbaLogUtilResponseFile)" Lines="@(_CorbaIDLJJavaCompilerArgs)" Overwrite="true" WriteOnlyWhenDifferent="true" />

        <ItemGroup>
            <FileWrites Include="$(CorbaLogUtilResponseFile)" />
        </ItemGroup>
    </Target>

    <Target Name="BuildCorbaLogUtil" DependsOnTargets="ResolveJavaCompiler;CorbaLogUtilResponseFile" Inputs="$(MSBuildThisFileFullPath);@(CorbaLogUtilSource);$(CorbaLogUtilResponseFile)" Outputs="$(CorbaLogUtilStampFile)">
        <Error Text="Could not locate javac executable." Condition=" '$(JavaCompilerPath)' == '' " />
        <Error Text="javac could not be located at '$(JavaCompilerPath)'." Condition="!Exists('$(JavaCompilerPath)')" />
        <Exec Command="chmod +x $(JavaCompilerPath) >/dev/null 2>&amp;1" IgnoreExitCode="true" IgnoreStandardErrorWarningFormat="true" StandardErrorImportance="low" ContinueOnError="true" Condition="$([MSBuild]::IsOSUnixLike())" />

        <Delete Files="$(CorbaLogUtilStampFile)" />
        <RemoveDir Directories="$(CorbaLogUtilOutputPath)" />
        <MakeDir Directories="$(CorbaLogUtilOutputPath)" />
        <Message Text="$(JavaCompilerExec) @$(CorbaLogUtilResponseFile)" />
        <Exec Command="$(JavaCompilerExec) @$(CorbaLogUtilResponseFile)" />
        <Touch Files="$(CorbaLogUtilStampFile)" AlwaysCreate="true" ForceTouch="true" />

        <ItemGroup>
            <FileWrites Include="$(CorbaLogUtilStampFile)" />
            <FileWrites Include="$(CorbaLogUtilOutputPath)**\*.class" />
            <CorbaLogUtilClasses Include="$(CorbaLogUtilOutputPath)**\*.class" />
        </ItemGroup>
    </Target>

    <PropertyGroup>
        <CorbaLogWrappersOutputPath>$(IntermediateOutputPath)corba_logwrappers\</CorbaLogWrappersOutputPath>
    </PropertyGroup>

    <ItemGroup>
        <CorbaLogWrappersSource Include="$(OpenJdkDir)corba\src\share\classes\com\sun\corba\se\spi\logging\data\*.mc" />
    </ItemGroup>

    <Target Name="BuildCorbaLogWrapperSources" DependsOnTargets="ResolveJava;BuildCorbaLogUtil" Inputs="$(MSBuildThisFileFullPath);@(CorbaLogUtilClasses);@(CorbaLogWrappersSource)" Outputs="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging\%(CorbaLogWrappersSource.Filename)SystemException.java">
        <Error Text="Could not locate java executable." Condition=" '$(JavaPath)' == '' " />
        <Error Text="java could not be located at '$(JavaPath)'." Condition="!Exists('$(JavaPath)')" />
        <Exec Command="chmod +x $(JavaPath) >/dev/null 2>&amp;1" IgnoreExitCode="true" IgnoreStandardErrorWarningFormat="true" StandardErrorImportance="low" ContinueOnError="true" Condition="$([MSBuild]::IsOSUnixLike())" />

        <ItemGroup>
            <_BuildCorbaLogWrappersDir Remove="@(_BuildCorbaLogWrappersDir)" />
            <_BuildCorbaLogWrappersDir Include="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging" />
        </ItemGroup>

        <Delete Files="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging\%(CorbaLogWrappersSource.Filename)SystemException.java" />
        <MakeDir Directories="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging" />
        <Message Text="$(JavaExec) -cp $(CorbaLogUtilOutputPath) com.sun.tools.corba.se.logutil.MC make-class %(CorbaLogWrappersSource.FullPath) @(_BuildCorbaLogWrappersDir)" />
        <Exec Command="$(JavaExec) -cp $(CorbaLogUtilOutputPath) com.sun.tools.corba.se.logutil.MC make-class %(CorbaLogWrappersSource.FullPath) @(_BuildCorbaLogWrappersDir)" />

        <ItemGroup>
            <FileWrites Include="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging\%(CorbaLogWrappersSource.Filename)SystemException.java" />
            <Compile Include="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging\%(CorbaLogWrappersSource.Filename)SystemException.java" />
        </ItemGroup>
    </Target>

    <PropertyGroup>
        <CoreCompileDependsOn>
            BuildCorbaLogWrapperSources;
            $(CoreCompileDependsOn);
        </CoreCompileDependsOn>
    </PropertyGroup>

    <Target Name="BuildCorbaLogWrapperResources" DependsOnTargets="ResolveJava;BuildCorbaLogUtil" Inputs="$(MSBuildThisFileFullPath);@(CorbaLogUtilClasses);@(CorbaLogWrappersSource)" Outputs="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging\%(CorbaLogWrappersSource.Filename)SystemException.resource">
        <Error Text="Could not locate javac executable." Condition=" '$(JavaCompilerPath)' == '' " />
        <Error Text="javac could not be located at '$(JavaCompilerPath)'." Condition="!Exists('$(JavaCompilerPath)')" />
        <Exec Command="chmod +x $(JavaCompilerPath) >/dev/null 2>&amp;1" IgnoreExitCode="true" IgnoreStandardErrorWarningFormat="true" StandardErrorImportance="low" ContinueOnError="true" Condition="$([MSBuild]::IsOSUnixLike())" />

        <ItemGroup>
            <_BuildCorbaLogWrappersDir Remove="@(_BuildCorbaLogWrappersDir)" />
            <_BuildCorbaLogWrappersDir Include="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging" />
        </ItemGroup>

        <Delete Files="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging\%(CorbaLogWrappersSource.Filename)SystemException.java" />
        <MakeDir Directories="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging" />
        <Message Text="$(JavaExec) -cp $(CorbaLogUtilOutputPath) com.sun.tools.corba.se.logutil.MC make-resource %(CorbaLogWrappersSource.FullPath) @(_BuildCorbaLogWrappersDir)" />
        <Exec Command="$(JavaExec) -cp $(CorbaLogUtilOutputPath) com.sun.tools.corba.se.logutil.MC make-resource %(CorbaLogWrappersSource.FullPath) @(_BuildCorbaLogWrappersDir)" />

        <ItemGroup>
            <FileWrites Include="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging\%(CorbaLogWrappersSource.Filename)SystemException.resource" />
            <CorbaLogWrapperResourceFile Include="$(CorbaLogWrappersOutputPath)com\sun\corba\se\impl\logging\%(CorbaLogWrappersSource.Filename)SystemException.resource" />
        </ItemGroup>
    </Target>

    <PropertyGroup>
        <CorbaLogWrapperPropertiesOutputPath>$(CorbaLogWrappersOutputPath)com/sun/corba/se/impl/logging/LogStrings.properties</CorbaLogWrapperPropertiesOutputPath>
    </PropertyGroup>

    <UsingTask TaskName="ConcatTextFiles" TaskFactory="RoslynCodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.Core.dll">
        <ParameterGroup>
            <SourceFiles ParameterType="Microsoft.Build.Framework.ITaskItem[]"  Required="true" />
            <OutputFile ParameterType="System.String" Required="true" />
        </ParameterGroup>
        <Task>
            <Using Namespace="System" />
            <Using Namespace="System.Linq" />
            <Using Namespace="System.Collections.Generic" />
            <Code Type="Fragment" Language="cs">
                <![CDATA[
                Directory.CreateDirectory(Path.GetDirectoryName(OutputFile));
                using var dst = new StreamWriter(File.Open(OutputFile, FileMode.Create));
                
                foreach (var file in SourceFiles)
                {
                    using var src = File.OpenText(file.ItemSpec);
                
                    string line;
                    while ((line = src.ReadLine()) != null)
                        dst.WriteLine(line);
                }
                ]]>
            </Code>
        </Task>
    </UsingTask>

    <Target Name="GenerateCorbaLogWrapperProperties" DependsOnTargets="BuildCorbaLogWrapperResources" Inputs="$(MSBuildThisFileFullPath);@(CorbaLogWrapperResourceFile)" Outputs="$(CorbaLogWrapperPropertiesOutputPath)">
        <ConcatTextFiles SourceFiles="@(CorbaLogWrapperResourceFile)" OutputFile="$(CorbaLogWrapperPropertiesOutputPath)" />
        <ItemGroup>
            <FileWrites Include="$(CorbaLogWrapperPropertiesOutputPath)" />
            <JavaResource Include="$(CorbaLogWrapperPropertiesOutputPath)" PackagePath="com/sun/corba/se/impl/logging" />
        </ItemGroup>
    </Target>

    <PropertyGroup>
        <CoreCompileDependsOn>
            BuildCorbaLogWrapperResources;
            GenerateCorbaLogWrapperProperties;
            $(CoreCompileDependsOn);
        </CoreCompileDependsOn>
    </PropertyGroup>

    <PropertyGroup>
        <CorbaIDLOutputPath>$(IntermediateOutputPath)corba_idls\</CorbaIDLOutputPath>
        <CorbaIDLSourcePath>$(OpenJdkDir)corba\src\share\classes\</CorbaIDLSourcePath>
        <CorbaIDLTempPath>$(IntermediateOutputPath)corba_idls_tmp\</CorbaIDLTempPath>
        <CorbaIDLStampFile>$(CorbaIDLOutputPath)stamp</CorbaIDLStampFile>
    </PropertyGroup>

    <ItemGroup>
        <CorbaIDLSourceFile Include="$(CorbaIDLSourcePath)**\*.idl" />
        <CorbaIDLSourceFile Update="@(CorbaIDLSourceFile)" PackagePath="%(RecursiveDir)" />
        <CorbaIDLSourceFile Update="$(CorbaIDLSourcePath)com\sun\corba\se\PortalActivationIDL\activation.idl" Args="-oldImplBase" />
        <CorbaIDLSourceFile Update="$(CorbaIDLSourcePath)com\sun\corba\se\spi\activation\activation.idl" Args="-oldImplBase" />
        <CorbaIDLSourceFile Remove="$(CorbaIDLSourcePath)com\sun\tools\corba\se\idl\**\*.idl" />
        <CorbaIDLSourceFile Remove="$(CorbaIDLSourcePath)org\omg\CORBA\**\*.idl" />
        <CorbaIDLSourceFile Remove="$(CorbaIDLSourcePath)com\sun\corba\se\GiopIDL\**\*.idl" />
        <CorbaIDLSourceFile Remove="$(CorbaIDLSourcePath)org\omg\PortableServer\corba.idl" />
        <CorbaIDLIncludePath Include="$(CorbaIDLSourcePath)org\omg\CORBA" />
        <CorbaIDLIncludePath Include="$(CorbaIDLSourcePath)org\omg\PortableInterceptor" />
        <CorbaIDLIncludePath Include="$(CorbaIDLSourcePath)org\omg\PortableServer" />
    </ItemGroup>

    <ItemGroup>
        <CorbaIDLPrefix Include="CORBA" Prefix="org.omg" />
        <CorbaIDLPrefix Include="CosNaming" Prefix="org.omg" />
        <CorbaIDLPrefix Include="CosTransactions" Prefix="org.omg" />
        <CorbaIDLPrefix Include="CosTSInteroperation" Prefix="org.omg" />
        <CorbaIDLPrefix Include="DynamicAny" Prefix="org.omg" />
        <CorbaIDLPrefix Include="Dynamic" Prefix="org.omg" />
        <CorbaIDLPrefix Include="IOP" Prefix="org.omg" />
        <CorbaIDLPrefix Include="Messaging" Prefix="org.omg" />
        <CorbaIDLPrefix Include="PortableInterceptor" Prefix="org.omg" />
        <CorbaIDLPrefix Include="PortableServer" Prefix="org.omg" />
        <CorbaIDLPrefix Include="activation" Prefix="com.sun.corba.se.spi" />
        <CorbaIDLPrefix Include="GIOP" Prefix="com.sun.corba.se" />
        <CorbaIDLPrefix Include="PortableActivationIDL" Prefix="com.sun.corba.se" />
        <CorbaIDLPrefix Include="messages" Prefix="com.sun.corba.se" />
    </ItemGroup>

    <ItemGroup>
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)DYNANYDELETEFILES" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\*POA*" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\*Holder*" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\DynValueBoxHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\DynValueCommonHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\_DynValueCommonStub.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\_DynValueBoxStub.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\DynAnyPackage\TypeMismatchHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\DynAnyPackage\InvalidValueHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\DynamicAny\DynAnyFactoryPackage\InconsistentTypeCodeHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)IOPDELETEFILES" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\BI_DIR_IIOP.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\ChainBypassCheck.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\ChainBypassInfo.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\FORWARDED_IDENTITY.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\INVOCATION_POLICIES.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\LogicalThreadId.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\SendingContextRunTime.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\UnknownExceptionInfo.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\TaggedComponentSeqHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)POAHELHOLFILES" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\CurrentPackage\NoContextHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ForwardRequestHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\IdAssignmentPolicyValueHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\IdAssignmentPolicyValueHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\IdUniquenessPolicyValueHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\IdUniquenessPolicyValueHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ImplicitActivationPolicyValueHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ImplicitActivationPolicyValueHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\LifespanPolicyValueHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\LifespanPolicyValueHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ServantRetentionPolicyValueHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ServantRetentionPolicyValueHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ObjectIdHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ObjectIdHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAListHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAListHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAManagerPackage\AdapterInactiveHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAManagerPackage\StateHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAManagerPackage\StateHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\AdapterAlreadyExistsHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\AdapterNonExistentHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\InvalidPolicyHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\NoServantHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\ObjectAlreadyActiveHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\ObjectNotActiveHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\ServantAlreadyActiveHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\ServantNotActiveHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\WrongAdapterHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\POAPackage\WrongPolicyHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\RequestProcessingPolicyValueHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\RequestProcessingPolicyValueHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ServantActivatorHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ServantLocatorHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ThreadPolicyValueHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableServer\ThreadPolicyValueHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)PIHELHOLFILES" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ClientRequestInfoHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ClientRequestInterceptorHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\IORInfoHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\IORInterceptorHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\InterceptorHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ORBInitInfoHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ORBInitializerHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\PolicyFactoryHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ReplyStatusHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\RequestInfoHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ServerRequestInfoHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ServerRequestInterceptorHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\SlotIdHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ClientRequestInfoHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ClientRequestInterceptorHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\CurrentHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ForwardRequestHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\IORInfoHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\IORInterceptorHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\InterceptorHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\InvalidSlotHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ORBInitInfoHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ORBInitializerHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\PolicyFactoryHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\RequestInfoHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ServerRequestInfoHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ServerRequestInterceptorHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\TaggedComponentSeqHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ORBInitInfoPackage\DuplicateNameHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\PortableInterceptor\ORBInitInfoPackage\InvalidNameHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\CodecPackage\FormatMismatchHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\CodecPackage\InvalidTypeForEncodingHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\CodecPackage\TypeMismatchHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\CodecHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\EncodingFormatHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\EncodingHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\CodecFactoryPackage\UnknownEncodingHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\CodecFactoryHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\CodecHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\EncodingHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\IOP\TaggedComponentSeqHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\Dynamic\ContextListHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\Dynamic\ExceptionListHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\Dynamic\ParameterHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\Dynamic\ParameterListHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\Dynamic\ExceptionListHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\Dynamic\ParameterHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\Dynamic\ParameterListHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\Dynamic\RequestContextHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)CORBAX" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\CORBA\OctetSeqHelper.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\CORBA\OctetSeqHolder.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\CORBA\PolicyError.java" />
        <CorbaIDLDelete Include="$(CorbaIDLOutputPath)org\omg\CORBA\RepositoryIdHelper.java" />
    </ItemGroup>

    <Target Name="BuildCorbaIDLs" DependsOnTargets="ResolveJava;BuildCorbaIDLJ" Inputs="$(MSBuildThisFileFullPath);@(CorbaIDLSourceFile)" Outputs="$(CorbaIDLStampFile)">
        <Error Text="Could not locate java executable." Condition=" '$(JavaPath)' == '' " />
        <Error Text="java could not be located at '$(JavaPath)'." Condition="!Exists('$(JavaPath)')" />
        <Exec Command="chmod +x $(JavaPath) >/dev/null 2>&amp;1" IgnoreExitCode="true" IgnoreStandardErrorWarningFormat="true" StandardErrorImportance="low" ContinueOnError="true" Condition="$([MSBuild]::IsOSUnixLike())" />

        <RemoveDir Directories="$(CorbaIDLOutputPath)" />
        <MakeDir Directories="$(CorbaIDLOutputPath)" />
        <Message Text="$(JavaExec) -cp $(CorbaIDLJOutputPath) com.sun.tools.corba.se.idl.toJavaPortable.Compile -td $(CorbaIDLOutputPath) @(CorbaIDLIncludePath->'-i %(Identity)', ' ') -D CORBA3 -corba 3.0 -fall %(CorbaIDLSourceFile.Args) @(CorbaIDLPrefix->'-pkgPrefix %(Identity) %(Prefix)', ' ') %(CorbaIDLSourceFile.FullPath)" />
        <Exec Command="$(JavaExec) -cp $(CorbaIDLJOutputPath) com.sun.tools.corba.se.idl.toJavaPortable.Compile -td $(CorbaIDLOutputPath) @(CorbaIDLIncludePath->'-i %(Identity)', ' ') -D CORBA3 -corba 3.0 -fall %(CorbaIDLSourceFile.Args) @(CorbaIDLPrefix->'-pkgPrefix %(Identity) %(Prefix)', ' ') %(CorbaIDLSourceFile.FullPath)" />
        <Delete Files="@(CorbaIDLDelete)" />
        <Touch Files="$(CorbaIDLStampFile)" AlwaysCreate="true" ForceTouch="true" />

        <ItemGroup>
            <FileWrites Include="$(CorbaIDLOutputPath)**\*.java" />
            <FileWrites Include="$(CorbaIDLStampFile)" />
            <Compile Include="$(CorbaIDLOutputPath)**\*.java" />
        </ItemGroup>
    </Target>

    <PropertyGroup>
        <CoreCompileDependsOn>
            BuildCorbaIDLs;
            $(CoreCompileDependsOn);
        </CoreCompileDependsOn>
    </PropertyGroup>

</Project>
